<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>吉吉吉作品集</title>
  <style>
    body{font-family:"Noto Sans TC",sans-serif;margin:0;background:#f7f7fb;color:#222}
    header{background:#222;color:#fff;text-align:center;padding:18px;position:sticky;top:0;z-index:10}
    nav{display:flex;gap:14px;justify-content:center;align-items:center;padding:12px}
    nav a{color:#0a63c9;text-decoration:none;font-weight:700}
    nav a:hover{text-decoration:underline}
    .filters{display:flex;gap:8px;justify-content:center;flex-wrap:wrap;margin:10px 0 0}
    .chip{border:1px solid #d7d7e0;background:#fff;border-radius:999px;padding:6px 12px;font-size:14px;cursor:pointer}
    .chip.active{background:#e8f2ff;border-color:#9cc8ff}
    .grid{max-width:1100px;margin:16px auto;display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:16px;padding:0 16px}
    .card{background:#fff;border:1px solid #e6e6ef;border-radius:12px;overflow:hidden;box-shadow:0 4px 14px rgba(0,0,0,.06)}
    .card img{width:100%;height:220px;object-fit:cover;display:block}
    .cap{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;color:#666;font-size:13px}
    .pill{border:1px solid #9cc8ff;background:#eaf3ff;color:#0a63c9;border-radius:999px;padding:2px 8px;font-size:12px}
    footer{color:#777;text-align:center;padding:22px}
    .lightbox{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.75);z-index:50}
    .lightbox.open{display:flex}
    .lightbox img{max-width:min(92vw,1200px);max-height:85vh;border-radius:14px;box-shadow:0 20px 60px rgba(0,0,0,.5)}
    .close{position:fixed;top:14px;right:14px;background:rgba(255,255,255,.15);border:1px solid rgba(255,255,255,.3);color:#fff;border-radius:10px;padding:8px 10px;cursor:pointer}
  </style>
</head>
<body>
  <header>
    <h1>吉吉吉的作品集</h1>
    <nav>
      <a href="index.html">首頁</a>
      <a href="about.html">關於我</a>
    </nav>
    <div class="filters" id="filters"></div>
  </header>

  <main>
    <div id="grid" class="grid" aria-live="polite"></div>
  </main>

  <footer>© 2025 吉吉吉作品集</footer>

  <!-- 燈箱 -->
  <div class="lightbox" id="lightbox" role="dialog" aria-modal="true" aria-label="查看大圖">
    <img alt="預覽" />
    <button class="close" id="closeBox">關閉 Esc</button>
  </div>

  <script>
    const exts = ['jpg','jpeg','png','webp'];
    const allowedTags = ['平面設計','繪畫','自媒體','金犢獎'];
    const MAX = 200;

    async function collectImages(){
      const probes = [];
      for (let i=1;i<=MAX;i++){
        const num = String(i).padStart(2,'0');
        for (const tag of allowedTags){
          for (const ext of exts){
            const src = `images/${num}_${tag}.${ext}`;
            probes.append = probes.push(check(src, tag));
          }
        }
      }
      const list = (await Promise.all(probes)).filter(Boolean);
      list.sort((a,b)=> a.src.localeCompare(b.src, 'zh-Hant'));
      return list;
    }

    function check(src, tag){
      return new Promise(resolve=>{
        const img = new Image();
        img.onload = ()=> resolve({src, tag});
        img.onerror = ()=> resolve(null);
        img.src = src + '?v=' + Date.now();
      });
    }

    const grid = document.getElementById('grid');
    const filters = document.getElementById('filters');
    const lightbox = document.getElementById('lightbox');
    const lightImg = lightbox.querySelector('img');
    const closeBox = document.getElementById('closeBox');

    let all = [];
    let active = '全部';

    function render(items){
      grid.innerHTML = '';
      items.forEach(item=>{
        const fig = document.createElement('figure');
        fig.className = 'card';
        const img = document.createElement('img');
        img.loading = 'lazy'; img.decoding = 'async';
        img.src = item.src; img.alt = item.tag;
        img.onclick = ()=>{ lightImg.src = item.src; lightbox.classList.add('open'); };
        const cap = document.createElement('figcaption');
        cap.className = 'cap';
        cap.innerHTML = `<small>${item.src.split('/').pop()}</small><span class="pill">${item.tag}</span>`;
        fig.appendChild(img); fig.appendChild(cap);
        grid.appendChild(fig);
      });
    }

    function renderFilters(){
      const tags = Array.from(new Set(['全部', ...all.map(i=>i.tag)]));
      filters.innerHTML = '';
      tags.forEach(t=>{
        const b = document.createElement('button');
        b.className = 'chip' + (t===active?' active':'');
        b.textContent = t;
        b.onclick = ()=>{ active=t; apply(); renderFilters(); };
        filters.appendChild(b);
      });
    }

    function apply(){
      const list = active==='全部' ? all : all.filter(i=>i.tag===active);
      render(list);
    }

    closeBox.onclick = ()=> lightbox.classList.remove('open');
    lightbox.addEventListener('click', e=>{ if(e.target===lightbox) lightbox.classList.remove('open'); });
    window.addEventListener('keydown', e=>{ if(e.key==='Escape') lightbox.classList.remove('open'); });

    collectImages().then(list=>{ all=list; apply(); renderFilters(); });
  </script>
</body>
</html>
